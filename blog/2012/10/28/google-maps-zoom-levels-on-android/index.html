
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Google Maps zoom levels on Android - Adam Speakman</title>
	<meta name="author" content="Adam">

	
	<meta name="description" content="I had an interesting problem today where I needed to scale the default zoom for the map view for my Android app, depending on the screen size. I&# &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Adam Speakman" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Adam Speakman</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
    <li><a href="/about">About</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
    <li><a href="/about">About</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:adamsp.github.com/speakman-website">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/+AdamSpeakman?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/adamsnz" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/adamsp" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:adamsp.github.com/speakman-website">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Google Maps zoom levels on Android</h2>
	<div class="entry-content"><p>I had an interesting problem today where I needed to scale the default zoom for the map view for my <a href="https://play.google.com/store/apps/details?id=speakman.whatsshakingnz">Android app</a>, depending on the screen size. I&#8217;d previously hardcoded it to a zoom level of 6. This worked nicely on my testing device (a Nexus One) and looked OK (but not great) on a Galaxy S3 - but I saw it last night on a Nexus 7 and it looked ridiculous. My desire was to have the map view show the whole of New Zealand, filling up as much of the screen as possible. On the Nexus 7, the country was tiny.</p>

<!-- more -->


<p>I&#8217;d previously considered the fact that I would likely need to adjust the zoom level on a per-device level, and had added a method stub with the intent of adding some logic in there. Up til now I hadn&#8217;t bothered with it, as, well, &#8220;It works on my device!&#8221; However looking at it on this Nexus 7, I figured it was time to do something about it.</p>

<p>A bit of Googling around showed that the problem of zooming relative to screen size was common - but the <a href="http://stackoverflow.com/questions/2666922/auto-size-zoom-on-google-maps-in-java-depending-android-screen-resolution">common problem/solution</a> was to ensure the map zoomed to span a set of markers in an <code>ItemizedOverlay</code>. I specifically <strong>did not</strong> want to do this - I want to show the whole country, not just the areas where the earthquakes are!</p>

<p>The <code>MapController.zoomToSpan(int latSpanE6, int lonSpanE6)</code> method looked like it would do what I wanted, but honestly, it&#8217;s fucked. It gave me either zoom level 5 or zoom level 7, and I could never get it to give me zoom 6 (which is what I wanted, for the screen size on the emulator I was trying it on). Incrementally decreasing the size of the area I was requesting it to zoom to was no help. Admittedly the <a href="https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MapController#zoomToSpan(int, int)">documentation</a> gives no guarantees, and says that after the zoom &#8220;at least one of the new latitude or the new longitude will be within a factor of 2 from the corresponding parameter.&#8221; This wasn&#8217;t good enough.</p>

<p>I ended up doing it the hard way and experimenting with different screen resolution emulators until I found the right zooms. I figured 5, 6 and 7 would probably do it, depending on screen size. My code now looks like this:</p>

<figure class='code'><figcaption><span>getDefaultZoomForDevice() </span><a href='https://github.com/adamsp/wsnz-android/blob/master/Whats%20Shaking%20NZ/src/speakman/whatsshakingnz/fragments/MapFragment.java#L117'>Source</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='Java'><span class='line'><span class="kd">private</span> <span class="kt">int</span> <span class="nf">getDefaultZoomForDevice</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">WindowManager</span> <span class="n">wm</span> <span class="o">=</span> <span class="o">(</span><span class="n">WindowManager</span><span class="o">)</span> <span class="n">getActivity</span><span class="o">().</span><span class="na">getApplicationContext</span><span class="o">().</span><span class="na">getSystemService</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">WINDOW_SERVICE</span><span class="o">);</span>
</span><span class='line'>  <span class="n">Display</span> <span class="n">display</span> <span class="o">=</span> <span class="n">wm</span><span class="o">.</span><span class="na">getDefaultDisplay</span><span class="o">();</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="na">getWidth</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span><span class="o">(</span><span class="n">width</span> <span class="o">&lt;</span> <span class="mi">480</span><span class="o">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">5</span><span class="o">;</span>
</span><span class='line'>  <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">width</span> <span class="o">&lt;</span> <span class="mi">720</span><span class="o">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">6</span><span class="o">;</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">7</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I went with these resolutions because they represent some of the most common sizes among popular phones. Below 480px wide we have 320x480 devices such as the LG P500 (Optimus One) or the Galaxy Ace. Below 720px wide we have the common 480x800 devices such as my Nexus One, or the Galaxy S and Galaxy S II. And finally we have even larger devices with higher resolutions, such as the 720x1280 Galaxy S III (this is the most common device for all downloads of What&#8217;s Shaking, NZ? for Android) and HTC One X, and the 800x1280 Nexus 7 tablet.</p>

<p>There are some obvious problems with this solution. It&#8217;s not generic at all, and works only for New Zealand. The <code>Display.getWidth()</code> call is actually deprecated since API Level 13, however I want to support older devices as well - currently nearly 45% of all my downloads for this app are Android 2.3 and below. Also, note that this solution doesn&#8217;t work very well for people with strange resolution phones - anything that doesn&#8217;t fall into the broad categories I&#8217;ve defined above is likely to meet with a strange/unfortunate default zoom. However if your screen size is that weird, there&#8217;s probably not a whole lot more I can do about it - the Android Maps API doesn&#8217;t allow anything more granular than these discrete levels, and these zoom levels fit New Zealand to the screen the best for the given sizes. Lastly, it won&#8217;t scale properly when even larger devices are released.</p>

<p>However, despite these problems, I still found it to be the simplest, and most effective way of handling zoom at a per-device level. I would love to see a more granular zoom level (in Windows Phone you supply a double for zoom level), as it would presumably fix the problems with the <code>zoomToSpan</code> failures (this is a far more generic solution and would almost certainly be preferable). However, even if that does come about it won&#8217;t make much difference. With all these older devices still in use that won&#8217;t support it, it&#8217;ll take a long time to make enough of a dent in the user base that it&#8217;s worth thinking about again.</p>

<p><a href="/images/android-maps/android_maps_large.PNG"><img class="bottom" src="/images/android-maps/android_maps_large.PNG" width="160" height="240" title="Large screen, 720x1280px, zoom level 7" ></a>
<a href="/images/android-maps/android_maps_medium.PNG"><img class="bottom" src="/images/android-maps/android_maps_medium.PNG" width="160" height="240" title="Medium screen, 480x800px, zoom level 6" ></a>
<a href="/images/android-maps/android_maps_small.PNG"><img class="bottom" src="/images/android-maps/android_maps_small.PNG" width="160" height="240" title="Small screen, 320x480px, zoom level 5" ></a></p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-10-28T12:40:00-04:00" pubdate data-updated="true">Oct 28<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/android/'>android</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
		
		
		<a class="addthis_button_tweet"></a>
		
		
		<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
		
	</div>
	
	<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2017

    Adam

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->




	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-34453006-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>